<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Para Mar ‚Äî Galer√≠a & Mensaje</title>
<meta name="description" content="Felices 22!. Te dejo unos recuerdos y al final un mensaje para vos." />
<meta name="theme-color" content="#3b0d80" />
<style>
  :root{
    /* Paleta violeta + atardecer */
    --bg:#0b0717;               /* violeta muy oscuro */
    --bg-2:#120a24;             /* capa extra */
    --fg:#f7f7fb;
    --muted:#c7c3d9;
    --violet:#7b31ff;
    --violet-2:#b07cff;
    --sun-1:#ff9a5a;            /* naranja suave */
    --sun-2:#ff6fa9;            /* rosado */
    --sky-1:#67d5ff;            /* celeste */
    --card:#160d2b;             /* panel */
    --glass:#ffffff12;
    --radius:16px;
    --shadow:0 10px 30px rgba(0,0,0,.4);
    --ring: 0 0 0 2px #ffffff22 inset;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, sans-serif;
    background:
      radial-gradient(1000px 600px at 10% -10%, #1d0f39 0, transparent 50%),
      radial-gradient(900px 500px at 100% 0%, #451775 0, transparent 50%),
      linear-gradient(180deg, var(--bg) 0, var(--bg-2) 100%);
  }
  header{
    position:sticky; top:0; z-index:20; backdrop-filter:saturate(1.1) blur(8px);
    background:linear-gradient(180deg, #0b0717ee 0, #0b0717c8 60%, transparent);
    padding:14px 12px 10px; border-bottom:1px solid #ffffff18;
  }
  .hwrap{max-width:1100px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; gap:12px}
  .brand{display:flex; align-items:center; gap:12px}
  .logo{width:36px; height:36px; border-radius:12px; background:
    conic-gradient(from 210deg, var(--violet), var(--sun-2), var(--sun-1), var(--sky-1), var(--violet));
    box-shadow: var(--ring);}
  h1{margin:0; font-size:1.05rem; font-weight:800; letter-spacing:.2px;}
  .grad{
    background: linear-gradient(90deg, var(--violet), var(--sun-2), var(--sky-1));
    -webkit-background-clip:text; background-clip:text; color:transparent;
  }
  .hint{color:var(--muted); font-size:.9rem}

  main{max-width:1100px; margin:18px auto 120px; padding:0 12px}

  /* Masonry (columns) */
  .masonry{ column-width: 320px; column-gap: 14px; }
  @media (max-width:720px){ .masonry{ column-width: 220px; column-gap: 10px; } }
  .tile{ break-inside: avoid; display:block; margin:0 0 14px; border-radius: var(--radius); overflow:hidden; background:var(--card);
         border:1px solid #ffffff1a; box-shadow: var(--shadow); position:relative; cursor:pointer; }
  .tile .ph{ width:100%; height:100%; display:block; background:linear-gradient(135deg,#261344,#120a24); aspect-ratio:3/4; }
  .tile img, .tile video{ width:100%; height:auto; display:block; }
  .badge{
    position:absolute; top:8px; left:8px; padding:6px 10px; border-radius:999px; font-size:.75rem; font-weight:700;
    color:white; background:linear-gradient(90deg, #00000080, #00000020);
    border:1px solid #ffffff33; backdrop-filter: blur(4px);
  }
  .badge .dot{ display:inline-block; width:8px; height:8px; border-radius:999px; margin-right:6px; background:var(--violet-2); }
  .badge.video .dot{ background:var(--sun-1); }

  /* Lightbox */
  .overlay{ position:fixed; inset:0; display:none; place-items:center; z-index:50; }
  .overlay.active{ display:grid; }
  .backdrop{ position:absolute; inset:0; background:linear-gradient(180deg,#07040c 0,#0b0717ee 40%, #0b0717ee 100%); }
  .dialog{ position:relative; width:min(92vw, 960px); max-height:86vh; border-radius:20px; overflow:hidden; background:linear-gradient(180deg, #1a0f33, #120a24);
           border:1px solid #ffffff25; box-shadow: 0 30px 80px #000000aa; display:flex; flex-direction:column; }
  .viewer{ position:relative; display:grid; place-items:center; padding:8px; }
  .viewer img, .viewer video{ max-width:100%; max-height:64vh; width:auto; height:auto; border-radius:12px; background:#0b0717; }
  .desc{ padding:12px 14px 14px; color:#e9e7f5; border-top:1px solid #ffffff16; }
  .desc .meta{ color:var(--muted); font-size:.85rem; }
  .close, .navbtn{
    position:absolute; top:10px; background:#00000070; color:white; border:1px solid #ffffff40; border-radius:12px; width:40px; height:40px;
    display:grid; place-items:center; cursor:pointer; backdrop-filter: blur(4px); font-weight:900;
  }
  .close{ right:10px; }
  .navbtn{ top:calc(50% - 20px); }
  .prev{ left:10px; }
  .next{ right:10px; }

  /* Lock section */
  .lock{
    margin:26px 0 0; padding:16px; border-radius:var(--radius); background:linear-gradient(180deg, #1a0f33, #120a24);
    border:1px dashed #ffffff40; box-shadow:var(--shadow);
  }
  .title2{ margin:6px 0 8px; font-size:1.1rem; font-weight:800; }
  .note{ color:var(--muted); }
  .digits{ display:flex; gap:10px; margin:12px 0 14px; justify-content:center; }
  .digits input{ width:58px; height:68px; text-align:center; font-size:2rem; border-radius:12px; border:1px solid #ffffff33; background:#130b26; color:var(--fg); outline:none; box-shadow: inset 0 2px 0 #0000005a; }
  .digits input:focus{ border-color:#8ab7ff }
  .actions{ display:flex; gap:10px; justify-content:center; align-items:center; }
  button{ padding:12px 14px; border:0; border-radius:12px; font-weight:800; cursor:pointer; color:white; background:linear-gradient(90deg, var(--violet), var(--sun-2)); box-shadow: var(--ring); }
  .subtle{ background: #ffffff18; }
  .msg{ min-height:1.2em; text-align:center; font-weight:700; }
  .ok{ color:#3cffb3 } .err{ color:#ff6b88 }

  /* Final video */
  #final{ display:none; margin-top:16px; }
  .card{ background:linear-gradient(180deg,#1a0f33,#120a24); border:1px solid #ffffff1f; border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; }
  .card .head{ padding:12px 14px; border-bottom:1px solid #ffffff16; }
  .card .body{ padding:12px 14px 16px; }
  video.final{ width:100%; border-radius:12px; background:#0b0717 }

  /* Confetti */
  .confetti{ position:fixed; top:-8vh; width:10px; height:14px; transform:rotate(15deg); opacity:.95; z-index:9999; pointer-events:none }
  @keyframes fall { to { transform: translateY(110vh) rotate(360deg);} }

  footer{ position:fixed; inset-inline:0; bottom:10px; text-align:center; color:#bdb5d8; font-size:.85rem; opacity:.65 }

  @media (prefers-reduced-motion: reduce){
    .confetti{ display:none }
  }
  /* ===== Quad 2x2 (4 √≠tems visibles) ===== */
  .gallery.quad{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px; }
  .gallery.quad .tile{ margin:0; height: var(--tile-h, 40svh); }
  .gallery.quad .tile .ph,
  .gallery.quad .tile img,
  .gallery.quad .tile video{ width:100%; height:100%; object-fit:cover; aspect-ratio:auto; }
  @media (max-width:720px){ .gallery.quad{ gap:8px } }
</style>
</head>
<body>
  <header>
    <div class="hwrap">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1><span class="grad">Felices 22!</span> ‚Ä¢ Marchu üíú</h1>
      </div>
      <div class="hint">Te dejo unos recuerdos y al final un mensaje para vos</div>
    </div>
  </header>

  <main>
    <!-- Galer√≠a -->
    <section id="gallery" class="gallery quad" aria-label="Galer√≠a de fotos y videos"></section>

    <!-- Candado al fondo -->
    <section class="lock" id="lock">
      <div class="title2">Pone el c√≥digo y mir√° el video</div>
      
      <div class="digits" role="group" aria-label="C√≥digo de 4 d√≠gitos">
        <input inputmode="numeric" pattern="[0-9]*" maxlength="1" aria-label="D√≠gito 1" />
        <input inputmode="numeric" pattern="[0-9]*" maxlength="1" aria-label="D√≠gito 2" />
        <input inputmode="numeric" pattern="[0-9]*" maxlength="1" aria-label="D√≠gito 3" />
        <input inputmode="numeric" pattern="[0-9]*" maxlength="1" aria-label="D√≠gito 4" />
      </div>
      <div class="actions">
        <button id="check">Abrir video</button>
        <button class="subtle" id="reset">Limpiar</button>
      </div>
      <p class="note">Pista: mir√° tu brazo izquierdo...</p>
      <p id="msg" class="msg"></p>
    </section>

    <!-- Final: Video desbloqueado -->
    <section id="final" class="card" aria-hidden="true">
      <div class="head">
        <strong>Para vos Mar</strong> ‚Ä¢ <span class="grad">Feliz vida para ti</span> üéÇ
      </div>
      <div class="body">
        <p>Gracias por todos estos momentos. Te amo. Juani</p>
        <video id="finalVid" class="final" controls playsinline preload="metadata" poster="video/poster.jpg">
          <source src="video/mensaje.mp4" type="video/mp4" />
          Oh no...
        </video>
      </div>
    </section>
  </main>

  <footer>Hecho con mucho amorcito ‚ú®</footer>

  <!-- Lightbox / visor -->
  <div id="lightbox" class="overlay" role="dialog" aria-modal="true" aria-label="Visor de imagen o video">
    <div class="backdrop"></div>
    <div class="dialog">
      <button class="close" id="btnClose" aria-label="Cerrar">‚úï</button>
      <button class="navbtn prev" id="btnPrev" aria-label="Anterior">‚ùÆ</button>
      <button class="navbtn next" id="btnNext" aria-label="Siguiente">‚ùØ</button>
      <div class="viewer" id="viewer"></div>
      <div class="desc" id="lbDesc">
        <div class="meta" id="lbMeta"></div>
        <div id="lbText"></div>
      </div>
    </div>
  </div>

<script>
  // ========= CONFIG =========
  const CODE = '1111'; // C√≥digo para el video final

  // Ajusta la altura para que entren 2 filas exactas (2x2)
  (function(){
    const headerEl = document.querySelector('header');
    function setTileH(){
      const gap = 18; // px de margen aproximado entre filas
      const h = Math.max(120, Math.floor((window.innerHeight - headerEl.offsetHeight - gap*2) / 2));
      document.documentElement.style.setProperty('--tile-h', h + 'px');
    }
    window.addEventListener('load', setTileH, {once:true});
    window.addEventListener('resize', setTileH);
  })();

  // Lista de √≠tems de la galer√≠a (mezcla de im√°genes y videos)
  // Reemplaz√° src/desc con tus archivos reales. Pod√©s tener 40, 60, 100‚Ä¶ los que quieras.
  // type: 'img' | 'video'
  const ITEMS = [
    { type:'img',   src:'media/001.jpg', desc:'Nuestra primer Tutsy' },
    { type:'img',   src:'media/002.jpg', desc:'Deleitandome con tus primeras comidas' },
    { type:'video', src:'media/002.mp4', desc:'Cuando te cortaste el pelo :|' },
    { type:'img',   src:'media/004.jpg', desc:'Deleitandome con tu hermosura' },
    { type:'img',   src:'media/005.jpg', desc:'Haciendo match bebe' },
    { type:'img',   src:'media/006.jpg', desc:'Ac√° en un fiest√≥n' },
    { type:'img',   src:'media/007.jpg', desc:'Hubiera querdio hacer lo mismo este a√±o' },
    { type:'img',   src:'media/008.jpg', desc:'Cuando me volv√≠ a enamorar de vos' },
    { type:'img',   src:'media/009.jpg', desc:'Con la Cafuuu' },
    { type:'video', src:'media/010.mp4', desc:'Preparando de tus ricas pipsas' },
    { type:'img',   src:'media/011.jpg', desc:'Cuando fuimos a las caba√±as en el Valle' },
    { type:'img',   src:'media/012.jpg', desc:'Tirando unas poses en la caba√±ita' },
    { type:'img',   src:'media/013.jpg', desc:'Siendo completamente felices' },
    { type:'img',   src:'media/014.jpg', desc:'Fotito en el miradorr' },
    { type:'img',   src:'media/015.jpg', desc:'Admirando un paisaje incre√≠ble, y Los Reyunos de fondo' },
    { type:'img',   src:'media/016.jpg', desc:'Te abrazo en tu habitaci√≥n' },
    { type:'img',   src:'media/017.jpg', desc:'Ac√° saliendo bien bellacos' },
    { type:'img',   src:'media/018.jpg', desc:'En el espejo antes de salir' },
    { type:'img',   src:'media/019.jpg', desc:'Desayunando en un hermoso lugar' },
    { type:'img',   src:'media/020.jpg', desc:'Por comer el helado m√°s rico de mendo' },
    { type:'img',   src:'media/021.jpg', desc:'Cuando nos agarraron in fraganti' },
    { type:'img',   src:'media/022.jpg', desc:'Despu√©s de dormir al ado del r√≠o' },
    { type:'img',   src:'media/023.jpg', desc:'Fotito con el atardecer' },
    { type:'img',   src:'media/024.jpg', desc:'üòç üòç üòç' },
    { type:'img',   src:'media/025.jpg', desc:'Viajecito a Las Le√±as' },
    { type:'img',   src:'media/026.jpg', desc:'Siendo una con la monta√±a' },
    { type:'img',   src:'media/027.jpg', desc:'En la carpa regocijandonos de amor' },
    { type:'img',   src:'media/028.jpg', desc:'Que delicias' },
    { type:'img',   src:'media/029.jpg', desc:'Ac√° con el Doni' },
    { type:'img',   src:'media/030.jpg', desc:'En una terraza tomando unos drinks' },
    { type:'img',   src:'media/031.jpg', desc:'De gala bien pitucos' },
    { type:'img',   src:'media/032.jpg', desc:'Antes de tocar en Alvear' },
    { type:'img',   src:'media/033.jpg', desc:'En una sala de teatro solos' },
    { type:'img',   src:'media/034.jpg', desc:'Foto al solcito en el pasillo' },
    { type:'img',   src:'media/035.jpg', desc:'Payaseando en un resto' },
    { type:'img',   src:'media/036.jpg', desc:'‚ù§Ô∏è‚Äçü©π ‚ù§Ô∏è‚Äçü©π ‚ù§Ô∏è‚Äçü©π' },
    { type:'img',   src:'media/037.jpg', desc:'Mini session en la vereda' },
    { type:'img',   src:'media/038.jpg', desc:'Cara de "cumpl√≠ mi sue√±o no lo puedo creer"' },
    { type:'img',   src:'media/039.jpg', desc:'De paseo por Chile weon' },
    { type:'img',   src:'media/040.jpg', desc:'Haciendo una cumbresita' },
    { type:'img',   src:'media/041.jpg', desc:'En el campo tomando mates' },
    { type:'img',   src:'media/042.jpg', desc:'En el medio de un trekking Cerro Arco' },
    { type:'img',   src:'media/043.jpg', desc:'Fotito con el chorro de la javie' },
    { type:'img',   src:'media/044.jpg', desc:'Paseando en el valle' },
    { type:'img',   src:'media/045.jpg', desc:'Comiendo los mejores pancakes del mundo' },
    { type:'img',   src:'media/046.jpg', desc:'Matecitos en el Salto Colorado' },
    { type:'img',   src:'media/047.jpg', desc:'El sushi m√°s rico que he probado y vos' },
    { type:'img',   src:'media/048.jpg', desc:'Foto al sol en Los Molles' },
    { type:'img',   src:'media/049.jpg', desc:'The last one' },

    // üëâ Duplic√° el formato de arriba hasta tus +40 elementos.
  ];

  // ========= RENDER: galer√≠a =========
  const $gallery = document.getElementById('gallery');
  const frag = document.createDocumentFragment();

  ITEMS.forEach((item, idx) => {
    const fig = document.createElement('figure');
    fig.className = 'tile';
    fig.tabIndex = 0;
    fig.setAttribute('role','button');
    fig.setAttribute('aria-label', item.type === 'video' ? 'Abrir video' : 'Abrir foto');

    const badge = document.createElement('div');
    badge.className = 'badge ' + (item.type === 'video' ? 'video' : 'image');
    badge.innerHTML = `<span class="dot"></span>${item.type === 'video' ? 'Video' : 'Foto'}`;
    fig.appendChild(badge);

    if (item.type === 'img'){
      const img = document.createElement('img');
      img.loading = 'lazy';
      img.alt = item.desc || 'Foto';
      img.dataset.src = item.src; // lazy via IO
      img.className = 'ph';
      fig.appendChild(img);
    } else {
      const v = document.createElement('video');
      v.muted = true; v.playsInline = true; v.preload = 'metadata';
      if (item.poster) v.poster = item.poster;
      v.dataset.src = item.src; // lazy set later
      v.className = 'ph';
      fig.appendChild(v);
    }

    fig.addEventListener('click', ()=> openLightbox(idx));
    fig.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); openLightbox(idx);} });

    frag.appendChild(fig);
  });

  $gallery.appendChild(frag);

  // ========= Lazy loading con IntersectionObserver =========
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(e=>{
      if (e.isIntersecting){
        const el = e.target;
        const src = el.dataset.src;
        if (src){
          if (el.tagName === 'IMG') el.src = src;
          else if (el.tagName === 'VIDEO') el.src = src + '#t=0.1'; // apuntar a 0.1s para forzar thumbnail en algunos navegadores
          el.classList.remove('ph');
          io.unobserve(el);
        }
      }
    });
  }, { rootMargin:'200px 0px' });

  document.querySelectorAll('.tile img, .tile video').forEach(el=> io.observe(el));

  // ========= Lightbox =========
  const $overlay = document.getElementById('lightbox');
  const $viewer  = document.getElementById('viewer');
  const $lbText  = document.getElementById('lbText');
  const $lbMeta  = document.getElementById('lbMeta');
  const $btnClose= document.getElementById('btnClose');
  const $btnPrev = document.getElementById('btnPrev');
  const $btnNext = document.getElementById('btnNext');
  let current = 0;

  function openLightbox(idx){
    current = idx;
    renderLightbox();
    $overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
  function closeLightbox(){
    $overlay.classList.remove('active');
    $viewer.innerHTML = '';
    document.body.style.overflow = '';
  }
  function nav(delta){
    current = (current + delta + ITEMS.length) % ITEMS.length;
    renderLightbox();
  }
  function renderLightbox(){
    const it = ITEMS[current];
    $viewer.innerHTML = '';
    let node;
    if (it.type === 'img'){
      node = document.createElement('img');
      node.src = it.src;
      node.alt = it.desc || 'Foto';
    } else {
      node = document.createElement('video');
      node.controls = true; node.playsInline = true; node.autoplay = true;
      node.src = it.src;
      if (it.poster) node.poster = it.poster;
    }
    $viewer.appendChild(node);
    $lbText.textContent = it.desc || '';
    $lbMeta.textContent = `${current+1} / ${ITEMS.length} ¬∑ ${it.type === 'video' ? 'Video' : 'Foto'}`;
  }

  $btnClose.addEventListener('click', closeLightbox);
  $btnPrev.addEventListener('click', ()=>nav(-1));
  $btnNext.addEventListener('click', ()=>nav(1));
  $overlay.addEventListener('click', (e)=>{ if(e.target.classList.contains('backdrop')) closeLightbox(); });
  window.addEventListener('keydown', (e)=>{
    if (!$overlay.classList.contains('active')) return;
    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowLeft') nav(-1);
    if (e.key === 'ArrowRight') nav(1);
  });

  // ========= Candado =========
  const inputs = Array.from(document.querySelectorAll('.digits input'));
  const $msg   = document.getElementById('msg');
  const $check = document.getElementById('check');
  const $reset = document.getElementById('reset');
  const $final = document.getElementById('final');
  const $lock  = document.getElementById('lock');

  inputs.forEach((inp, idx)=>{
    inp.addEventListener('input', e=>{
      e.target.value = e.target.value.replace(/\D/g,'').slice(0,1);
      if (e.target.value && idx < inputs.length-1) inputs[idx+1].focus();
    });
    inp.addEventListener('keydown', e=>{
      if (e.key === 'Backspace' && !inp.value && idx>0) inputs[idx-1].focus();
    });
  });

  const codeValue = () => inputs.map(i=>i.value||'').join('');
  const showMsg = (txt, cls) => { $msg.textContent = txt; $msg.className = 'msg ' + (cls||''); };

  $check.addEventListener('click', tryUnlock);
  inputs[inputs.length-1].addEventListener('input', ()=>{ if (codeValue().length===4) tryUnlock(); });
  $reset.addEventListener('click', ()=>{ inputs.forEach(i=>i.value=''); inputs[0].focus(); showMsg('', ''); });

  function tryUnlock(){
    const v = codeValue();
    if (v.length<4) return showMsg('Ingres√° los 4 d√≠gitos', 'err');
    if (v === CODE){
      showMsg('¬°Correcto! Abriendo‚Ä¶','ok');
      celebrate(22);
      $lock.style.display = 'none';
      $final.style.display = 'block';
      setTimeout(()=> document.getElementById('finalVid')?.scrollIntoView({behavior:'smooth'}), 300);
    } else {
      showMsg('Mmm‚Ä¶ no. Pista: cuatro iguales üòâ', 'err');
      shake($lock);
    }
  }

  function shake(el){
    el.animate([
      {transform:'translateX(0)'}, {transform:'translateX(-6px)'}, {transform:'translateX(6px)'}, {transform:'translateX(0)'}
    ], {duration:260, iterations:1});
  }

  function celebrate(n=22){
    for (let i=0;i<n;i++){
      const s = document.createElement('div'); s.className='confetti';
      s.style.left = Math.random()*100 + 'vw';
      s.style.background = `hsl(${Math.floor(Math.random()*360)} 90% 60%)`;
      s.style.animation = `fall ${3+Math.random()*2}s linear forwards`;
      s.style.transform = `rotate(${Math.random()*360}deg)`;
      document.body.appendChild(s);
      setTimeout(()=>s.remove(), 5500);
    }
  }

  // Easter egg: escribir "MAR" abre el final
  let cheat='';
  window.addEventListener('keydown', e=>{
    cheat = (cheat + e.key.toUpperCase()).slice(-3);
    if (cheat === 'MAR'){ $lock.style.display='none'; $final.style.display='block'; celebrate(8); }
  });
</script>
</body>
</html>
